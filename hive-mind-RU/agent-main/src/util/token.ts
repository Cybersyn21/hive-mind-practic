// Пространство имён для оценки количества токенов в тексте
// Используется для приблизительного подсчёта токенов перед отправкой в языковые модели
export namespace Token {
  // Среднее количество символов на один токен
  // Эмпирическое значение 4 символа ≈ 1 токен для английского текста
  const CHARS_PER_TOKEN = 4

  // Оценивает количество токенов в строке
  // Использует простую эвристику: длина строки / среднее число символов на токен
  // Возвращает приблизительное количество токенов (округлённое до целого)
  export function estimate(input: string) {
    // Защита от null/undefined: используем пустую строку по умолчанию
    // Math.max(0, ...) гарантирует, что результат не будет отрицательным
    return Math.max(0, Math.round((input || "").length / CHARS_PER_TOKEN))
  }
}
