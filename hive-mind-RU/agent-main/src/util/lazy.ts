// Создаёт ленивую (lazy) функцию, которая вычисляет значение только при первом вызове
// Последующие вызовы возвращают закешированный результат без повторного выполнения
// Используется для отложенной инициализации дорогостоящих вычислений
export function lazy<T>(fn: () => T) {
  // Переменная для хранения вычисленного значения
  let value: T | undefined
  // Флаг, указывающий, было ли значение уже вычислено
  let loaded = false

  // Возвращаем функцию-обёртку, которая управляет ленивым вычислением
  return (): T => {
    // Если значение уже загружено, возвращаем его без повторных вычислений
    if (loaded) return value as T
    // Помечаем, что значение загружено
    loaded = true
    // Вызываем исходную функцию для получения значения
    value = fn()
    // Возвращаем вычисленное значение
    return value as T
  }
}
