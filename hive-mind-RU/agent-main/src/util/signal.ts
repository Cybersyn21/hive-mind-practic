// Создаёт простой сигнал (signal) для синхронизации асинхронных операций
// Возвращает объект с методами trigger() для активации и wait() для ожидания
// Полезно для координации выполнения между разными частями кода
export function signal() {
  // Переменная для хранения функции resolve из промиса
  let resolve: any
  // Создаём промис и сохраняем его функцию resolve
  const promise = new Promise((r) => (resolve = r))
  return {
    // Активирует сигнал, резолвя промис
    // Все, кто ждут через wait(), получат разрешение
    trigger() {
      return resolve()
    },
    // Возвращает промис для ожидания активации сигнала
    // Промис будет разрешён при вызове trigger()
    wait() {
      return promise
    },
  }
}
