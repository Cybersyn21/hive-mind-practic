# Каталог mcp/ — Model Context Protocol

## Описание

Каталог `mcp/` содержит реализацию интеграции с Model Context Protocol (MCP) — стандартом для расширения возможностей AI-моделей через внешние серверы.

## Что такое MCP?

Model Context Protocol — это открытый протокол, позволяющий AI-моделям взаимодействовать с внешними инструментами и источниками данных через стандартизированный интерфейс.

**Преимущества MCP**:
- Унифицированный API для всех инструментов
- Безопасная изоляция
- Динамическое подключение серверов
- Поддержка множества провайдеров

## Файлы

### index.ts
**Назначение**: Главный модуль MCP интеграции.

**Функциональность**:
- Подключение к MCP серверам
- Обнаружение доступных инструментов
- Маршрутизация вызовов
- Обработка ответов

## Архитектура MCP

```
┌─────────────────────────────────────────────────────────────┐
│                         Агент                                │
│              (Запрос на использование инструмента)          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                     MCP Client (index.ts)                    │
│  • Обнаружение серверов                                     │
│  • Маршрутизация запросов                                   │
│  • Сериализация/десериализация                              │
└─────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        ▼                     ▼                     ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  MCP Server 1 │     │  MCP Server 2 │     │  MCP Server N │
│  (Playwright) │     │    (SQL)      │     │    (...)      │
└───────────────┘     └───────────────┘     └───────────────┘
```

## Поддерживаемые MCP серверы

Агент может подключаться к любым MCP-совместимым серверам:

| Сервер | Описание |
|--------|----------|
| Playwright | Автоматизация браузера |
| SQL | Работа с базами данных |
| Git | Операции с репозиториями |
| Filesystem | Расширенная работа с файлами |
| Web | Веб-запросы и парсинг |

## Конфигурация

MCP серверы настраиваются через конфигурационный файл:

```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": ["@playwright/mcp-server"]
    },
    "sql": {
      "command": "npx",
      "args": ["@mcp/sql-server", "--database", "postgres://..."]
    }
  }
}
```

## Использование

```typescript
import { MCPClient } from './mcp';

// Инициализация клиента
const mcp = new MCPClient();

// Подключение к серверу
await mcp.connect('playwright');

// Получение списка инструментов
const tools = await mcp.listTools();

// Вызов инструмента
const result = await mcp.call('browser_navigate', {
  url: 'https://example.com'
});
```

## Интеграция с агентом

Когда AI-модель решает использовать MCP-инструмент:

1. Агент определяет, что инструмент — MCP
2. Находит соответствующий сервер
3. Отправляет запрос через MCP протокол
4. Получает результат и возвращает AI

## Протокол коммуникации

MCP использует JSON-RPC 2.0 через stdio:

```json
// Запрос
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "browser_navigate",
    "arguments": { "url": "https://example.com" }
  }
}

// Ответ
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [{ "type": "text", "text": "Navigated to..." }]
  }
}
```

## Ссылки

- [MCP Specification](https://modelcontextprotocol.io/)
- [MCP SDK](https://github.com/modelcontextprotocol/sdk)
